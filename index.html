<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>New Webpage</title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="assets/css/reset.css">
        <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    </head>
    <body>
    	<div id="bg">
    	<br>
    	<div id="newspaper">
    		<h1>Trivia Game</h1>
	    	<div class="html">
	    		<button class="startBtn">Start</button>
	    	</div>
		</div>
		</div>

	<script>
		var trivia = {
			questions: ["name", "color"],
			answers: [
					["jin","ken", "ryu", "mike"],
					["red", "yellow", "pink", "blue"]
					],
			answerIndex: ["1", "2"],
		};
		console.log(trivia.answers[0][0]);
		var time = 10;
		var html;
		var setIntervalId;
		var correct = 0;
		var incorrect = 0;
		var unanswered = 0;
		var questionNumber = 0;
		
		$(".startBtn").on("click", function(){
			displayQuestion();
			startTimer();
		});
		function startTimer(){
			setIntervalId = setInterval(timer, 1000);
		}
		function timer(){
			time--;
			$("#displayTime").html(time);
			if (time === 0){
				$(".html").html(
				"<p>Time Remaining: " + "<span>" + time + "</span>" + " Seconds</p>" + "<p>Out of Time!</p>");
				console.log("time out");
				unanswered++;
				// clearInterval(setIntervalId);
				setTimeout(displayQuestion, 1000 * 5);
				time = 15;
				questionNumber++;
			}
		};
		function displayQuestion(){
			console.log("game started");
			$(".html").html(
				"<p>Time Remaining: " + "<span id='displayTime'></span>" + " Seconds</p>");		
			for (var i=0; i<4; i++){
			var newDiv = $("<button>");
			newDiv.attr("data-value", i);
			newDiv.addClass("btn");
			newDiv.html(trivia.answers[questionNumber][i]);
			$(".html").append(newDiv);
			}
			answeringQuestion();
		};

		function answeringQuestion(){
			$(".btn").on("click", function(){
				console.log("button pressed");
				var userAnswer = $(this).attr("data-value");
				// userAnswer = parseInt(userAnswer);
				if (userAnswer === trivia.answerIndex[questionNumber]){
					console.log("correct!");
					correct++;
					$(".html").html(
						"<p>Time Remaining: " + "<span>" + time + "</span>" + " Seconds</p>" +
						"<p>Correct!</p>");
					setTimeout(displayQuestion, 1000 * 5);
					time = 15;
				}
				else{
					console.log("not correct");
					incorrect++;
					$(".html").html(
						"<p>Time Remaining: " + "<span>" + time + "</span>" + " Seconds</p>" +
						"<p>Incorrect</p>");
					setTimeout(displayQuestion, 1000 * 5);
					time = 15;
				}

				questionNumber++;
			});

			if (questionNumber === trivia.questions.length -1){
					console.log("no more questions");
					clearInterval(setIntervalId);
					result();
				}
		}
		function result(){
			console.log("here is result");
			$(".html").html(
				"<p>All done, heres how you did!</p>" + 
				"<p>Correct Answers: " + correct + "</p>" +
				"<p>Incorrect Answers: " + incorrect + "</p>" +
				"<p>Unanswered: " + unanswered + "</p>" +
				"<button id='restartBtn'>Start Over?</button>");
			$("#restartBtn").on("click", function(){
				initializeGame();
				displayQuestion();
				startTimer();
			});
		}

		function initializeGame(){
			time = 10;
			correct = 0;
			incorrect = 0;
			unanswered = 0;
			questionNumber = 0;
		}
		

	</script>
    
    </body>
</html>

